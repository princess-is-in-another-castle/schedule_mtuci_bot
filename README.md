# Бот, который знает твоё расписание

### О функционале

##### FilesToDb.kt

Запускает функции, которые качают файлы с расписанием с сайта и добавляет в базу данных группы и расписание по группам.

##### Main.kt

Запускает бота. Чтобы Main.kt нормально работал, нужно предварительно загрузить данные в базу данных.


> ### Главная проблема в работе бота(или же почему я сам его не захостил):
> после того, как shadowJar соберёт jar файл при помощи обычной команды
> ```
> gradlew build
> ```
> и потом его запустить с помощью команды:
> ```
> java -jar build/libs/scratch_schedule_mtuci_bot-1.0-all.jar
> ```
> Всё вроде бы хорошо запускается, работает и не выдаёт ошибок. Но он не взаимодействует с базой данных. Если же
> запускать просто в IntelliJ IDEA Main.kt, транзакции с базой проходят на ура.
>
> Я лично пытался захостить на heroku, но из-за того, что нужно запускать jar файл, бросил это. Или нужно иначе собирать
> fat jar, чтобы он мог общаться с базой (я понятия не имею, в чём проблема), или же запускать по-другому. Я выбрал 
> третий путь — оставить это дело.

## Что нужно для запуска
###Java SE Development Kit 15.0.2
Чтобы проверить свою версию в консоли пропишите `java --version`

### Для общения с дб используется [Kotlin Exposed](https://github.com/JetBrains/Exposed)

Почитайте их [Wiki DataBase](https://github.com/JetBrains/Exposed/wiki/DataBase-and-DataSource), чтобы понять, какую
зависимость нужно добавить в build.gradle и что прописать в `.env` (я по умолчанию добавил зависимость для
взаимодействия с postgresql).

### Так же здесь используется [dotenv](https://github.com/cdimascio/dotenv-kotlin)

Поэтому не забудьте добавить в корень файлик `.env` и пропишите внутри:

```
TOKEN = ваш токен
DATABASE_URL = url дб
DATABASE_DRIVER = драйвер дб
DATABASE_USER = логин бд
DATABASE_PASSWORD = пароль бд
```